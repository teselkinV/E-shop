{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Wrapper = exports.withFormsy = exports.validationRules = exports.propTypes = exports.addValidationRule = undefined;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _formDataToObject = require('form-data-to-object');\n\nvar _formDataToObject2 = _interopRequireDefault(_formDataToObject);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _utils = require('./utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _validationRules = require('./validationRules');\n\nvar _validationRules2 = _interopRequireDefault(_validationRules);\n\nvar _Wrapper = require('./Wrapper');\n\nvar _Wrapper2 = _interopRequireDefault(_Wrapper);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/* eslint-disable react/no-unused-state, react/default-props-match-prop-types */\n\n\nvar Formsy = function (_React$Component) {\n  _inherits(Formsy, _React$Component);\n\n  function Formsy(props) {\n    _classCallCheck(this, Formsy);\n\n    var _this = _possibleConstructorReturn(this, (Formsy.__proto__ || Object.getPrototypeOf(Formsy)).call(this, props));\n\n    _this.getChildContext = function () {\n      return {\n        formsy: {\n          attachToForm: _this.attachToForm,\n          detachFromForm: _this.detachFromForm,\n          validate: _this.validate,\n          isFormDisabled: _this.isFormDisabled,\n          isValidValue: function isValidValue(component, value) {\n            return _this.runValidation(component, value).isValid;\n          }\n        }\n      };\n    };\n\n    _this.componentDidMount = function () {\n      _this.validateForm();\n    };\n\n    _this.componentWillUpdate = function () {\n      // Keep a reference to input names before form updates,\n      // to check if inputs has changed after render\n      _this.prevInputNames = _this.inputs.map(function (component) {\n        return component.props.name;\n      });\n    };\n\n    _this.componentDidUpdate = function () {\n      if (_this.props.validationErrors && _typeof(_this.props.validationErrors) === 'object' && Object.keys(_this.props.validationErrors).length > 0) {\n        _this.setInputValidationErrors(_this.props.validationErrors);\n      }\n\n      var newInputNames = _this.inputs.map(function (component) {\n        return component.props.name;\n      });\n\n      if (_utils2.default.arraysDiffer(_this.prevInputNames, newInputNames)) {\n        _this.validateForm();\n      }\n    };\n\n    _this.getCurrentValues = function () {\n      return _this.inputs.reduce(function (data, component) {\n        var name = component.props.name;\n        var dataCopy = Object.assign({}, data); // avoid param reassignment\n\n        dataCopy[name] = component.state.value;\n        return dataCopy;\n      }, {});\n    };\n\n    _this.getModel = function () {\n      var currentValues = _this.getCurrentValues();\n\n      return _this.mapModel(currentValues);\n    };\n\n    _this.getPristineValues = function () {\n      return _this.inputs.reduce(function (data, component) {\n        var name = component.props.name;\n        var dataCopy = Object.assign({}, data); // avoid param reassignment\n\n        dataCopy[name] = component.props.value;\n        return dataCopy;\n      }, {});\n    };\n\n    _this.setFormPristine = function (isPristine) {\n      _this.setState({\n        formSubmitted: !isPristine\n      }); // Iterate through each component and set it as pristine\n      // or \"dirty\".\n\n\n      _this.inputs.forEach(function (component) {\n        component.setState({\n          formSubmitted: !isPristine,\n          isPristine: isPristine\n        });\n      });\n    };\n\n    _this.setInputValidationErrors = function (errors) {\n      _this.inputs.forEach(function (component) {\n        var name = component.props.name;\n        var args = [{\n          isValid: !(name in errors),\n          validationError: typeof errors[name] === 'string' ? [errors[name]] : errors[name]\n        }];\n        component.setState.apply(component, args);\n      });\n    };\n\n    _this.isFormDisabled = function () {\n      return _this.props.disabled;\n    };\n\n    _this.mapModel = function (model) {\n      if (_this.props.mapping) {\n        return _this.props.mapping(model);\n      }\n\n      return _formDataToObject2.default.toObj(Object.keys(model).reduce(function (mappedModel, key) {\n        var keyArray = key.split('.');\n        var base = mappedModel;\n\n        while (keyArray.length) {\n          var currentKey = keyArray.shift();\n          base[currentKey] = keyArray.length ? base[currentKey] || {} : model[key];\n          base = base[currentKey];\n        }\n\n        return mappedModel;\n      }, {}));\n    };\n\n    _this.reset = function (data) {\n      _this.setFormPristine(true);\n\n      _this.resetModel(data);\n    };\n\n    _this.resetInternal = function (event) {\n      event.preventDefault();\n\n      _this.reset();\n\n      if (_this.props.onReset) {\n        _this.props.onReset();\n      }\n    };\n\n    _this.resetModel = function (data) {\n      _this.inputs.forEach(function (component) {\n        var name = component.props.name;\n\n        if (data && Object.prototype.hasOwnProperty.call(data, name)) {\n          component.setValue(data[name]);\n        } else {\n          component.resetValue();\n        }\n      });\n\n      _this.validateForm();\n    };\n\n    _this.runValidation = function (component) {\n      var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : component.state.value;\n\n      var currentValues = _this.getCurrentValues();\n\n      var _component$props = component.props,\n          validationError = _component$props.validationError,\n          validationErrors = _component$props.validationErrors;\n\n      var validationResults = _utils2.default.runRules(value, currentValues, component.validations, _validationRules2.default);\n\n      var requiredResults = _utils2.default.runRules(value, currentValues, component.requiredValidations, _validationRules2.default);\n\n      var isRequired = Object.keys(component.requiredValidations).length ? !!requiredResults.success.length : false;\n      var isValid = !validationResults.failed.length && !(_this.props.validationErrors && _this.props.validationErrors[component.props.name]);\n      return {\n        isRequired: isRequired,\n        isValid: isRequired ? false : isValid,\n        error: function () {\n          if (isValid && !isRequired) {\n            return [];\n          }\n\n          if (validationResults.errors.length) {\n            return validationResults.errors;\n          }\n\n          if (_this.props.validationErrors && _this.props.validationErrors[component.props.name]) {\n            return typeof _this.props.validationErrors[component.props.name] === 'string' ? [_this.props.validationErrors[component.props.name]] : _this.props.validationErrors[component.props.name];\n          }\n\n          if (isRequired) {\n            var error = validationErrors[requiredResults.success[0]];\n            return error ? [error] : null;\n          }\n\n          if (validationResults.failed.length) {\n            return validationResults.failed.map(function (failed) {\n              return validationErrors[failed] ? validationErrors[failed] : validationError;\n            }).filter(function (x, pos, arr) {\n              return arr.indexOf(x) === pos;\n            }); // remove duplicates\n          }\n\n          return undefined;\n        }()\n      };\n    };\n\n    _this.attachToForm = function (component) {\n      if (_this.inputs.indexOf(component) === -1) {\n        _this.inputs.push(component);\n      }\n\n      _this.validate(component);\n    };\n\n    _this.detachFromForm = function (component) {\n      var componentPos = _this.inputs.indexOf(component);\n\n      if (componentPos !== -1) {\n        _this.inputs = _this.inputs.slice(0, componentPos).concat(_this.inputs.slice(componentPos + 1));\n      }\n\n      _this.validateForm();\n    };\n\n    _this.isChanged = function () {\n      return !_utils2.default.isSame(_this.getPristineValues(), _this.getCurrentValues());\n    };\n\n    _this.submit = function (event) {\n      if (event && event.preventDefault) {\n        event.preventDefault();\n      } // Trigger form as not pristine.\n      // If any inputs have not been touched yet this will make them dirty\n      // so validation becomes visible (if based on isPristine)\n\n\n      _this.setFormPristine(false);\n\n      var model = _this.getModel();\n\n      _this.props.onSubmit(model, _this.resetModel, _this.updateInputsWithError);\n\n      if (_this.state.isValid) {\n        _this.props.onValidSubmit(model, _this.resetModel, _this.updateInputsWithError);\n      } else {\n        _this.props.onInvalidSubmit(model, _this.resetModel, _this.updateInputsWithError);\n      }\n    };\n\n    _this.updateInputsWithError = function (errors) {\n      Object.keys(errors).forEach(function (name) {\n        var component = _utils2.default.find(_this.inputs, function (input) {\n          return input.props.name === name;\n        });\n\n        if (!component) {\n          throw new Error('You are trying to update an input that does not exist. Verify errors object with input names. ' + JSON.stringify(errors));\n        }\n\n        var args = [{\n          isValid: _this.props.preventExternalInvalidation,\n          externalError: typeof errors[name] === 'string' ? [errors[name]] : errors[name]\n        }];\n        component.setState.apply(component, args);\n      });\n    };\n\n    _this.validate = function (component) {\n      // Trigger onChange\n      if (_this.state.canChange) {\n        _this.props.onChange(_this.getCurrentValues(), _this.isChanged());\n      }\n\n      var validation = _this.runValidation(component); // Run through the validations, split them up and call\n      // the validator IF there is a value or it is required\n\n\n      component.setState({\n        isValid: validation.isValid,\n        isRequired: validation.isRequired,\n        validationError: validation.error,\n        externalError: null\n      }, _this.validateForm);\n    };\n\n    _this.validateForm = function () {\n      // We need a callback as we are validating all inputs again. This will\n      // run when the last component has set its state\n      var onValidationComplete = function onValidationComplete() {\n        var allIsValid = _this.inputs.every(function (component) {\n          return component.state.isValid;\n        });\n\n        _this.setState({\n          isValid: allIsValid\n        });\n\n        if (allIsValid) {\n          _this.props.onValid();\n        } else {\n          _this.props.onInvalid();\n        } // Tell the form that it can start to trigger change events\n\n\n        _this.setState({\n          canChange: true\n        });\n      }; // Run validation again in case affected by other inputs. The\n      // last component validated will run the onValidationComplete callback\n\n\n      _this.inputs.forEach(function (component, index) {\n        var validation = _this.runValidation(component);\n\n        if (validation.isValid && component.state.externalError) {\n          validation.isValid = false;\n        }\n\n        component.setState({\n          isValid: validation.isValid,\n          isRequired: validation.isRequired,\n          validationError: validation.error,\n          externalError: !validation.isValid && component.state.externalError ? component.state.externalError : null\n        }, index === _this.inputs.length - 1 ? onValidationComplete : null);\n      }); // If there are no inputs, set state where form is ready to trigger\n      // change event. New inputs might be added later\n\n\n      if (!_this.inputs.length) {\n        _this.setState({\n          canChange: true\n        });\n      }\n    };\n\n    _this.render = function () {\n      var _this$props = _this.props,\n          getErrorMessage = _this$props.getErrorMessage,\n          getErrorMessages = _this$props.getErrorMessages,\n          getValue = _this$props.getValue,\n          hasValue = _this$props.hasValue,\n          isFormDisabled = _this$props.isFormDisabled,\n          isFormSubmitted = _this$props.isFormSubmitted,\n          isPristine = _this$props.isPristine,\n          isRequired = _this$props.isRequired,\n          isValid = _this$props.isValid,\n          isValidValue = _this$props.isValidValue,\n          mapping = _this$props.mapping,\n          onChange = _this$props.onChange,\n          onInvalidSubmit = _this$props.onInvalidSubmit,\n          onInvalid = _this$props.onInvalid,\n          onReset = _this$props.onReset,\n          onSubmit = _this$props.onSubmit,\n          onValid = _this$props.onValid,\n          onValidSubmit = _this$props.onValidSubmit,\n          preventExternalInvalidation = _this$props.preventExternalInvalidation,\n          resetValue = _this$props.resetValue,\n          setValidations = _this$props.setValidations,\n          setValue = _this$props.setValue,\n          showError = _this$props.showError,\n          showRequired = _this$props.showRequired,\n          validationErrors = _this$props.validationErrors,\n          nonFormsyProps = _objectWithoutProperties(_this$props, ['getErrorMessage', 'getErrorMessages', 'getValue', 'hasValue', 'isFormDisabled', 'isFormSubmitted', 'isPristine', 'isRequired', 'isValid', 'isValidValue', 'mapping', 'onChange', 'onInvalidSubmit', 'onInvalid', 'onReset', 'onSubmit', 'onValid', 'onValidSubmit', 'preventExternalInvalidation', 'resetValue', 'setValidations', 'setValue', 'showError', 'showRequired', 'validationErrors']);\n\n      return _react2.default.createElement('form', _extends({\n        onReset: _this.resetInternal,\n        onSubmit: _this.submit\n      }, nonFormsyProps, {\n        disabled: false\n      }), _this.props.children);\n    };\n\n    _this.state = {\n      isValid: true,\n      isSubmitting: false,\n      canChange: false\n    };\n    _this.inputs = [];\n    return _this;\n  } // Reset each key in the model to the original / initial / specified value\n  // Checks validation on current value or a passed value\n  // Method put on each input component to register\n  // itself to the form\n  // Method put on each input component to unregister\n  // itself from the form\n  // Checks if the values have changed from their initial value\n  // Update model, submit to url prop and send the model\n  // Go through errors from server and grab the components\n  // stored in the inputs map. Change their state to invalid\n  // and set the serverError message\n  // Use the binded values and the actual input value to\n  // validate the input and set its state. Then check the\n  // state of the form itself\n  // Validate the form by going through all child input components\n  // and check their state\n\n\n  return Formsy;\n}(_react2.default.Component);\n\nFormsy.displayName = 'Formsy';\nFormsy.defaultProps = {\n  children: null,\n  disabled: false,\n  getErrorMessage: function getErrorMessage() {},\n  getErrorMessages: function getErrorMessages() {},\n  getValue: function getValue() {},\n  hasValue: function hasValue() {},\n  isFormDisabled: function isFormDisabled() {},\n  isFormSubmitted: function isFormSubmitted() {},\n  isPristine: function isPristine() {},\n  isRequired: function isRequired() {},\n  isValid: function isValid() {},\n  isValidValue: function isValidValue() {},\n  mapping: null,\n  onChange: function onChange() {},\n  onError: function onError() {},\n  onInvalid: function onInvalid() {},\n  onInvalidSubmit: function onInvalidSubmit() {},\n  onReset: function onReset() {},\n  onSubmit: function onSubmit() {},\n  onValid: function onValid() {},\n  onValidSubmit: function onValidSubmit() {},\n  preventExternalInvalidation: false,\n  resetValue: function resetValue() {},\n  setValidations: function setValidations() {},\n  setValue: function setValue() {},\n  showError: function showError() {},\n  showRequired: function showRequired() {},\n  validationErrors: null\n};\nFormsy.propTypes = {\n  children: _propTypes2.default.node,\n  disabled: _propTypes2.default.bool,\n  getErrorMessage: _propTypes2.default.func,\n  getErrorMessages: _propTypes2.default.func,\n  getValue: _propTypes2.default.func,\n  hasValue: _propTypes2.default.func,\n  isFormDisabled: _propTypes2.default.func,\n  isFormSubmitted: _propTypes2.default.func,\n  isPristine: _propTypes2.default.func,\n  isRequired: _propTypes2.default.func,\n  isValid: _propTypes2.default.func,\n  isValidValue: _propTypes2.default.func,\n  mapping: _propTypes2.default.func,\n  onChange: _propTypes2.default.func,\n  onInvalid: _propTypes2.default.func,\n  onInvalidSubmit: _propTypes2.default.func,\n  onReset: _propTypes2.default.func,\n  onSubmit: _propTypes2.default.func,\n  onValid: _propTypes2.default.func,\n  onValidSubmit: _propTypes2.default.func,\n  preventExternalInvalidation: _propTypes2.default.bool,\n  resetValue: _propTypes2.default.func,\n  setValidations: _propTypes2.default.func,\n  setValue: _propTypes2.default.func,\n  showError: _propTypes2.default.func,\n  showRequired: _propTypes2.default.func,\n  validationErrors: _propTypes2.default.object // eslint-disable-line\n\n};\nFormsy.childContextTypes = {\n  formsy: _propTypes2.default.object\n};\n\nvar addValidationRule = function addValidationRule(name, func) {\n  _validationRules2.default[name] = func;\n};\n\nvar withFormsy = _Wrapper2.default;\nvar didWarnAboutWrapperDeprecation = false;\n\nvar deprecatedWrapper = function deprecatedWrapper(Component) {\n  if (!didWarnAboutWrapperDeprecation) {\n    // eslint-disable-next-line no-console\n    console.warn('Wrapper has been renamed to withFormsy. Importing Wrapper from formsy-react is depreacted and will be removed in the future. Please rename your Wrapper imports to withFormsy.');\n    didWarnAboutWrapperDeprecation = true;\n  }\n\n  return withFormsy(Component);\n};\n\nexports.addValidationRule = addValidationRule;\nexports.propTypes = _Wrapper.propTypes;\nexports.validationRules = _validationRules2.default;\nexports.withFormsy = withFormsy;\nexports.Wrapper = deprecatedWrapper;\nexports.default = Formsy;","map":{"version":3,"sources":["/Users/vladimir/Desktop/Projects/Ecommerce/e-shop/node_modules/segmented-control/node_modules/formsy-react/lib/index.js"],"names":["Object","defineProperty","exports","value","Wrapper","withFormsy","validationRules","propTypes","addValidationRule","undefined","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_typeof","Symbol","iterator","obj","constructor","_formDataToObject","require","_formDataToObject2","_interopRequireDefault","_propTypes","_propTypes2","_react","_react2","_utils","_utils2","_validationRules","_validationRules2","_Wrapper","_Wrapper2","__esModule","default","_objectWithoutProperties","keys","indexOf","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","enumerable","writable","configurable","setPrototypeOf","__proto__","Formsy","_React$Component","props","_this","getPrototypeOf","getChildContext","formsy","attachToForm","detachFromForm","validate","isFormDisabled","isValidValue","component","runValidation","isValid","componentDidMount","validateForm","componentWillUpdate","prevInputNames","inputs","map","name","componentDidUpdate","validationErrors","setInputValidationErrors","newInputNames","arraysDiffer","getCurrentValues","reduce","data","dataCopy","state","getModel","currentValues","mapModel","getPristineValues","setFormPristine","isPristine","setState","formSubmitted","forEach","errors","args","validationError","apply","disabled","model","mapping","toObj","mappedModel","keyArray","split","base","currentKey","shift","reset","resetModel","resetInternal","event","preventDefault","onReset","setValue","resetValue","_component$props","validationResults","runRules","validations","requiredResults","requiredValidations","isRequired","success","failed","error","filter","x","pos","arr","push","componentPos","slice","concat","isChanged","isSame","submit","onSubmit","updateInputsWithError","onValidSubmit","onInvalidSubmit","find","input","Error","JSON","stringify","preventExternalInvalidation","externalError","canChange","onChange","validation","onValidationComplete","allIsValid","every","onValid","onInvalid","index","render","_this$props","getErrorMessage","getErrorMessages","getValue","hasValue","isFormSubmitted","setValidations","showError","showRequired","nonFormsyProps","createElement","children","isSubmitting","Component","displayName","defaultProps","onError","node","bool","func","object","childContextTypes","didWarnAboutWrapperDeprecation","deprecatedWrapper","console","warn"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Wrapper = exports.withFormsy = exports.validationRules = exports.propTypes = exports.addValidationRule = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _formDataToObject = require('form-data-to-object');\n\nvar _formDataToObject2 = _interopRequireDefault(_formDataToObject);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _utils = require('./utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _validationRules = require('./validationRules');\n\nvar _validationRules2 = _interopRequireDefault(_validationRules);\n\nvar _Wrapper = require('./Wrapper');\n\nvar _Wrapper2 = _interopRequireDefault(_Wrapper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable react/no-unused-state, react/default-props-match-prop-types */\n\nvar Formsy = function (_React$Component) {\n  _inherits(Formsy, _React$Component);\n\n  function Formsy(props) {\n    _classCallCheck(this, Formsy);\n\n    var _this = _possibleConstructorReturn(this, (Formsy.__proto__ || Object.getPrototypeOf(Formsy)).call(this, props));\n\n    _this.getChildContext = function () {\n      return {\n        formsy: {\n          attachToForm: _this.attachToForm,\n          detachFromForm: _this.detachFromForm,\n          validate: _this.validate,\n          isFormDisabled: _this.isFormDisabled,\n          isValidValue: function isValidValue(component, value) {\n            return _this.runValidation(component, value).isValid;\n          }\n        }\n      };\n    };\n\n    _this.componentDidMount = function () {\n      _this.validateForm();\n    };\n\n    _this.componentWillUpdate = function () {\n      // Keep a reference to input names before form updates,\n      // to check if inputs has changed after render\n      _this.prevInputNames = _this.inputs.map(function (component) {\n        return component.props.name;\n      });\n    };\n\n    _this.componentDidUpdate = function () {\n      if (_this.props.validationErrors && _typeof(_this.props.validationErrors) === 'object' && Object.keys(_this.props.validationErrors).length > 0) {\n        _this.setInputValidationErrors(_this.props.validationErrors);\n      }\n\n      var newInputNames = _this.inputs.map(function (component) {\n        return component.props.name;\n      });\n      if (_utils2.default.arraysDiffer(_this.prevInputNames, newInputNames)) {\n        _this.validateForm();\n      }\n    };\n\n    _this.getCurrentValues = function () {\n      return _this.inputs.reduce(function (data, component) {\n        var name = component.props.name;\n\n        var dataCopy = Object.assign({}, data); // avoid param reassignment\n        dataCopy[name] = component.state.value;\n        return dataCopy;\n      }, {});\n    };\n\n    _this.getModel = function () {\n      var currentValues = _this.getCurrentValues();\n      return _this.mapModel(currentValues);\n    };\n\n    _this.getPristineValues = function () {\n      return _this.inputs.reduce(function (data, component) {\n        var name = component.props.name;\n\n        var dataCopy = Object.assign({}, data); // avoid param reassignment\n        dataCopy[name] = component.props.value;\n        return dataCopy;\n      }, {});\n    };\n\n    _this.setFormPristine = function (isPristine) {\n      _this.setState({\n        formSubmitted: !isPristine\n      });\n\n      // Iterate through each component and set it as pristine\n      // or \"dirty\".\n      _this.inputs.forEach(function (component) {\n        component.setState({\n          formSubmitted: !isPristine,\n          isPristine: isPristine\n        });\n      });\n    };\n\n    _this.setInputValidationErrors = function (errors) {\n      _this.inputs.forEach(function (component) {\n        var name = component.props.name;\n\n        var args = [{\n          isValid: !(name in errors),\n          validationError: typeof errors[name] === 'string' ? [errors[name]] : errors[name]\n        }];\n        component.setState.apply(component, args);\n      });\n    };\n\n    _this.isFormDisabled = function () {\n      return _this.props.disabled;\n    };\n\n    _this.mapModel = function (model) {\n      if (_this.props.mapping) {\n        return _this.props.mapping(model);\n      }\n\n      return _formDataToObject2.default.toObj(Object.keys(model).reduce(function (mappedModel, key) {\n        var keyArray = key.split('.');\n        var base = mappedModel;\n        while (keyArray.length) {\n          var currentKey = keyArray.shift();\n          base[currentKey] = keyArray.length ? base[currentKey] || {} : model[key];\n          base = base[currentKey];\n        }\n        return mappedModel;\n      }, {}));\n    };\n\n    _this.reset = function (data) {\n      _this.setFormPristine(true);\n      _this.resetModel(data);\n    };\n\n    _this.resetInternal = function (event) {\n      event.preventDefault();\n      _this.reset();\n      if (_this.props.onReset) {\n        _this.props.onReset();\n      }\n    };\n\n    _this.resetModel = function (data) {\n      _this.inputs.forEach(function (component) {\n        var name = component.props.name;\n\n        if (data && Object.prototype.hasOwnProperty.call(data, name)) {\n          component.setValue(data[name]);\n        } else {\n          component.resetValue();\n        }\n      });\n      _this.validateForm();\n    };\n\n    _this.runValidation = function (component) {\n      var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : component.state.value;\n\n      var currentValues = _this.getCurrentValues();\n      var _component$props = component.props,\n          validationError = _component$props.validationError,\n          validationErrors = _component$props.validationErrors;\n\n\n      var validationResults = _utils2.default.runRules(value, currentValues, component.validations, _validationRules2.default);\n\n      var requiredResults = _utils2.default.runRules(value, currentValues, component.requiredValidations, _validationRules2.default);\n\n      var isRequired = Object.keys(component.requiredValidations).length ? !!requiredResults.success.length : false;\n      var isValid = !validationResults.failed.length && !(_this.props.validationErrors && _this.props.validationErrors[component.props.name]);\n\n      return {\n        isRequired: isRequired,\n        isValid: isRequired ? false : isValid,\n        error: function () {\n          if (isValid && !isRequired) {\n            return [];\n          }\n\n          if (validationResults.errors.length) {\n            return validationResults.errors;\n          }\n\n          if (_this.props.validationErrors && _this.props.validationErrors[component.props.name]) {\n            return typeof _this.props.validationErrors[component.props.name] === 'string' ? [_this.props.validationErrors[component.props.name]] : _this.props.validationErrors[component.props.name];\n          }\n\n          if (isRequired) {\n            var error = validationErrors[requiredResults.success[0]];\n            return error ? [error] : null;\n          }\n\n          if (validationResults.failed.length) {\n            return validationResults.failed.map(function (failed) {\n              return validationErrors[failed] ? validationErrors[failed] : validationError;\n            }).filter(function (x, pos, arr) {\n              return arr.indexOf(x) === pos;\n            }); // remove duplicates\n          }\n\n          return undefined;\n        }()\n      };\n    };\n\n    _this.attachToForm = function (component) {\n      if (_this.inputs.indexOf(component) === -1) {\n        _this.inputs.push(component);\n      }\n\n      _this.validate(component);\n    };\n\n    _this.detachFromForm = function (component) {\n      var componentPos = _this.inputs.indexOf(component);\n\n      if (componentPos !== -1) {\n        _this.inputs = _this.inputs.slice(0, componentPos).concat(_this.inputs.slice(componentPos + 1));\n      }\n\n      _this.validateForm();\n    };\n\n    _this.isChanged = function () {\n      return !_utils2.default.isSame(_this.getPristineValues(), _this.getCurrentValues());\n    };\n\n    _this.submit = function (event) {\n      if (event && event.preventDefault) {\n        event.preventDefault();\n      }\n\n      // Trigger form as not pristine.\n      // If any inputs have not been touched yet this will make them dirty\n      // so validation becomes visible (if based on isPristine)\n      _this.setFormPristine(false);\n      var model = _this.getModel();\n      _this.props.onSubmit(model, _this.resetModel, _this.updateInputsWithError);\n      if (_this.state.isValid) {\n        _this.props.onValidSubmit(model, _this.resetModel, _this.updateInputsWithError);\n      } else {\n        _this.props.onInvalidSubmit(model, _this.resetModel, _this.updateInputsWithError);\n      }\n    };\n\n    _this.updateInputsWithError = function (errors) {\n      Object.keys(errors).forEach(function (name) {\n        var component = _utils2.default.find(_this.inputs, function (input) {\n          return input.props.name === name;\n        });\n        if (!component) {\n          throw new Error('You are trying to update an input that does not exist. Verify errors object with input names. ' + JSON.stringify(errors));\n        }\n        var args = [{\n          isValid: _this.props.preventExternalInvalidation,\n          externalError: typeof errors[name] === 'string' ? [errors[name]] : errors[name]\n        }];\n        component.setState.apply(component, args);\n      });\n    };\n\n    _this.validate = function (component) {\n      // Trigger onChange\n      if (_this.state.canChange) {\n        _this.props.onChange(_this.getCurrentValues(), _this.isChanged());\n      }\n\n      var validation = _this.runValidation(component);\n      // Run through the validations, split them up and call\n      // the validator IF there is a value or it is required\n      component.setState({\n        isValid: validation.isValid,\n        isRequired: validation.isRequired,\n        validationError: validation.error,\n        externalError: null\n      }, _this.validateForm);\n    };\n\n    _this.validateForm = function () {\n      // We need a callback as we are validating all inputs again. This will\n      // run when the last component has set its state\n      var onValidationComplete = function onValidationComplete() {\n        var allIsValid = _this.inputs.every(function (component) {\n          return component.state.isValid;\n        });\n\n        _this.setState({\n          isValid: allIsValid\n        });\n\n        if (allIsValid) {\n          _this.props.onValid();\n        } else {\n          _this.props.onInvalid();\n        }\n\n        // Tell the form that it can start to trigger change events\n        _this.setState({\n          canChange: true\n        });\n      };\n\n      // Run validation again in case affected by other inputs. The\n      // last component validated will run the onValidationComplete callback\n      _this.inputs.forEach(function (component, index) {\n        var validation = _this.runValidation(component);\n        if (validation.isValid && component.state.externalError) {\n          validation.isValid = false;\n        }\n        component.setState({\n          isValid: validation.isValid,\n          isRequired: validation.isRequired,\n          validationError: validation.error,\n          externalError: !validation.isValid && component.state.externalError ? component.state.externalError : null\n        }, index === _this.inputs.length - 1 ? onValidationComplete : null);\n      });\n\n      // If there are no inputs, set state where form is ready to trigger\n      // change event. New inputs might be added later\n      if (!_this.inputs.length) {\n        _this.setState({\n          canChange: true\n        });\n      }\n    };\n\n    _this.render = function () {\n      var _this$props = _this.props,\n          getErrorMessage = _this$props.getErrorMessage,\n          getErrorMessages = _this$props.getErrorMessages,\n          getValue = _this$props.getValue,\n          hasValue = _this$props.hasValue,\n          isFormDisabled = _this$props.isFormDisabled,\n          isFormSubmitted = _this$props.isFormSubmitted,\n          isPristine = _this$props.isPristine,\n          isRequired = _this$props.isRequired,\n          isValid = _this$props.isValid,\n          isValidValue = _this$props.isValidValue,\n          mapping = _this$props.mapping,\n          onChange = _this$props.onChange,\n          onInvalidSubmit = _this$props.onInvalidSubmit,\n          onInvalid = _this$props.onInvalid,\n          onReset = _this$props.onReset,\n          onSubmit = _this$props.onSubmit,\n          onValid = _this$props.onValid,\n          onValidSubmit = _this$props.onValidSubmit,\n          preventExternalInvalidation = _this$props.preventExternalInvalidation,\n          resetValue = _this$props.resetValue,\n          setValidations = _this$props.setValidations,\n          setValue = _this$props.setValue,\n          showError = _this$props.showError,\n          showRequired = _this$props.showRequired,\n          validationErrors = _this$props.validationErrors,\n          nonFormsyProps = _objectWithoutProperties(_this$props, ['getErrorMessage', 'getErrorMessages', 'getValue', 'hasValue', 'isFormDisabled', 'isFormSubmitted', 'isPristine', 'isRequired', 'isValid', 'isValidValue', 'mapping', 'onChange', 'onInvalidSubmit', 'onInvalid', 'onReset', 'onSubmit', 'onValid', 'onValidSubmit', 'preventExternalInvalidation', 'resetValue', 'setValidations', 'setValue', 'showError', 'showRequired', 'validationErrors']);\n\n      return _react2.default.createElement('form', _extends({\n        onReset: _this.resetInternal,\n        onSubmit: _this.submit\n      }, nonFormsyProps, {\n        disabled: false\n      }), _this.props.children);\n    };\n\n    _this.state = {\n      isValid: true,\n      isSubmitting: false,\n      canChange: false\n    };\n    _this.inputs = [];\n    return _this;\n  }\n\n  // Reset each key in the model to the original / initial / specified value\n\n\n  // Checks validation on current value or a passed value\n\n\n  // Method put on each input component to register\n  // itself to the form\n\n\n  // Method put on each input component to unregister\n  // itself from the form\n\n\n  // Checks if the values have changed from their initial value\n\n\n  // Update model, submit to url prop and send the model\n\n\n  // Go through errors from server and grab the components\n  // stored in the inputs map. Change their state to invalid\n  // and set the serverError message\n\n\n  // Use the binded values and the actual input value to\n  // validate the input and set its state. Then check the\n  // state of the form itself\n\n\n  // Validate the form by going through all child input components\n  // and check their state\n\n\n  return Formsy;\n}(_react2.default.Component);\n\nFormsy.displayName = 'Formsy';\n\nFormsy.defaultProps = {\n  children: null,\n  disabled: false,\n  getErrorMessage: function getErrorMessage() {},\n  getErrorMessages: function getErrorMessages() {},\n  getValue: function getValue() {},\n  hasValue: function hasValue() {},\n  isFormDisabled: function isFormDisabled() {},\n  isFormSubmitted: function isFormSubmitted() {},\n  isPristine: function isPristine() {},\n  isRequired: function isRequired() {},\n  isValid: function isValid() {},\n  isValidValue: function isValidValue() {},\n  mapping: null,\n  onChange: function onChange() {},\n  onError: function onError() {},\n  onInvalid: function onInvalid() {},\n  onInvalidSubmit: function onInvalidSubmit() {},\n  onReset: function onReset() {},\n  onSubmit: function onSubmit() {},\n  onValid: function onValid() {},\n  onValidSubmit: function onValidSubmit() {},\n  preventExternalInvalidation: false,\n  resetValue: function resetValue() {},\n  setValidations: function setValidations() {},\n  setValue: function setValue() {},\n  showError: function showError() {},\n  showRequired: function showRequired() {},\n  validationErrors: null\n};\n\nFormsy.propTypes = {\n  children: _propTypes2.default.node,\n  disabled: _propTypes2.default.bool,\n  getErrorMessage: _propTypes2.default.func,\n  getErrorMessages: _propTypes2.default.func,\n  getValue: _propTypes2.default.func,\n  hasValue: _propTypes2.default.func,\n  isFormDisabled: _propTypes2.default.func,\n  isFormSubmitted: _propTypes2.default.func,\n  isPristine: _propTypes2.default.func,\n  isRequired: _propTypes2.default.func,\n  isValid: _propTypes2.default.func,\n  isValidValue: _propTypes2.default.func,\n  mapping: _propTypes2.default.func,\n  onChange: _propTypes2.default.func,\n  onInvalid: _propTypes2.default.func,\n  onInvalidSubmit: _propTypes2.default.func,\n  onReset: _propTypes2.default.func,\n  onSubmit: _propTypes2.default.func,\n  onValid: _propTypes2.default.func,\n  onValidSubmit: _propTypes2.default.func,\n  preventExternalInvalidation: _propTypes2.default.bool,\n  resetValue: _propTypes2.default.func,\n  setValidations: _propTypes2.default.func,\n  setValue: _propTypes2.default.func,\n  showError: _propTypes2.default.func,\n  showRequired: _propTypes2.default.func,\n  validationErrors: _propTypes2.default.object // eslint-disable-line\n};\n\nFormsy.childContextTypes = {\n  formsy: _propTypes2.default.object\n};\n\nvar addValidationRule = function addValidationRule(name, func) {\n  _validationRules2.default[name] = func;\n};\n\nvar withFormsy = _Wrapper2.default;\n\nvar didWarnAboutWrapperDeprecation = false;\n\nvar deprecatedWrapper = function deprecatedWrapper(Component) {\n  if (!didWarnAboutWrapperDeprecation) {\n    // eslint-disable-next-line no-console\n    console.warn('Wrapper has been renamed to withFormsy. Importing Wrapper from formsy-react is depreacted and will be removed in the future. Please rename your Wrapper imports to withFormsy.');\n    didWarnAboutWrapperDeprecation = true;\n  }\n\n  return withFormsy(Component);\n};\n\nexports.addValidationRule = addValidationRule;\nexports.propTypes = _Wrapper.propTypes;\nexports.validationRules = _validationRules2.default;\nexports.withFormsy = withFormsy;\nexports.Wrapper = deprecatedWrapper;\nexports.default = Formsy;"]},"metadata":{},"sourceType":"script"}